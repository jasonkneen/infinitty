async function u(l,i={},n){return window.__TAURI_INTERNALS__.invoke(l,i,n)}function _(l,i,n,e){function h(r){return r instanceof n?r:new n(function(o){o(r)})}return new(n||(n=Promise))(function(r,o){function c(t){try{s(e.next(t))}catch(d){o(d)}}function a(t){try{s(e.throw(t))}catch(d){o(d)}}function s(t){t.done?r(t.value):h(t.value).then(c,a)}s((e=e.apply(l,[])).next())})}class f{constructor(){this._listeners=[]}get event(){return this._event||(this._event=i=>(this._listeners.push(i),{dispose:()=>{for(let e=0;e<this._listeners.length;e++)if(this._listeners[e]===i){this._listeners.splice(e,1);return}}})),this._event}fire(i){const n=[];for(let e=0;e<this._listeners.length;e++)n.push(this._listeners[e]);for(let e=0;e<n.length;e++)n[e].call(void 0,i)}}function m(l,i,n){return new y(l,i,n)}class y{constructor(i,n,e){var h,r,o,c,a,s,t,d,v;this._onData=new f,this._onExit=new f,n=typeof n=="string"?[n]:n??[];const p={file:i,args:n,termName:(h=e?.name)!==null&&h!==void 0?h:"Terminal",cols:(r=e?.cols)!==null&&r!==void 0?r:null,rows:(o=e?.rows)!==null&&o!==void 0?o:null,cwd:(c=e?.cwd)!==null&&c!==void 0?c:null,env:(a=e?.env)!==null&&a!==void 0?a:{},encoding:(s=e?.encoding)!==null&&s!==void 0?s:null,handleFlowControl:(t=e?.handleFlowControl)!==null&&t!==void 0?t:null,flowControlPause:(d=e?.flowControlPause)!==null&&d!==void 0?d:null,flowControlResume:(v=e?.flowControlResume)!==null&&v!==void 0?v:null};this._exitted=!1,this._init=u("plugin:pty|spawn",p).then(w=>{this.pid=w,this.readData(),this.wait()})}dispose(){throw new Error("Method not implemented.")}get onData(){return this._onData.event}get onExit(){return this._onExit.event}resize(i,n){this.cols=i,this.rows=n,this._init.then(()=>u("plugin:pty|resize",{pid:this.pid,cols:i,rows:n}).catch(e=>{console.error("Resize error: ",e)}))}clear(){console.warn("clear is un implemented!")}write(i){this._init.then(()=>u("plugin:pty|write",{pid:this.pid,data:i}).catch(n=>{console.error("Writing error: ",n)}))}kill(i){this._init.then(()=>u("plugin:pty|kill",{pid:this.pid}))}pause(){throw new Error("Method not implemented.")}resume(){throw new Error("Method not implemented.")}readData(){return _(this,void 0,void 0,function*(){yield this._init;try{for(;;){const i=yield u("plugin:pty|read",{pid:this.pid});this._onData.fire(i)}}catch(i){if(typeof i=="string"&&i.includes("EOF"))return;console.error("Reading error: ",i)}})}wait(){return _(this,void 0,void 0,function*(){if(!this._exitted)try{const i=yield u("plugin:pty|exitstatus",{pid:this.pid});this._exitted=!0,this._onExit.fire({exitCode:i})}catch(i){console.error(i)}})}}export{m as spawn};
